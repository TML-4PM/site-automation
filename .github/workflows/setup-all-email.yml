name: Setup Email - All Domains
on:
  workflow_dispatch:
jobs:
  setup-email:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      max-parallel: 5
      matrix:
        domain: [tech4humanity.com.au, holo-org.com, workfamilyai.org, augmentedhumanity.coach, gcbat.org, ratpak.io, neuropak.io, myneuralsignal.com, mcp-native.com, enteraustralia.tech, far-cage.org, aisweetspots.com, troylatter.com, spotto.app, holowog.io, ratworks.io, ratworks.com.au, ratpak.com.au, aquame.com.au, workfamilyai.com, laserdrone.io, giftfinder.au, dronelightshows.com.au, neurostack.io, neural-ennead.com, holowall.io, ai-era-thinking.com, consentx.io, laserdroneshow.com]
    steps:
      - run: |
          D="${{ matrix.domain }}"
          echo "ðŸ”§ $D"
          curl -s -X POST "https://api.migadu.com/v1/domains" -u "${{ secrets.MIGADU_API_USER }}:${{ secrets.MIGADU_API_KEY }}" -H "Content-Type: application/json" -d "{\"name\": \"$D\"}" || true
          for m in info hello support contact admin sales help team jobs hr media; do
            curl -s -X POST "https://api.migadu.com/v1/domains/$D/mailboxes" -u "${{ secrets.MIGADU_API_USER }}:${{ secrets.MIGADU_API_KEY }}" -H "Content-Type: application/json" -d "{\"local_part\": \"$m\", \"name\": \"Tech 4 Humanity\", \"password_method\": \"none\", \"recipients\": [\"troy@tech4humanity.com.au\"]}" || true
          done
          echo "âœ… $D (11 mailboxes)"
